ผมได้เขียนโค้ด Python สำหรับระบบ LINE Official Account ของมหาวิทยาลัยตามที่คุณต้องการแล้วครับ โค้ดนี้รองรับฟังก์ชันทั้งหมดที่คุณระบุ:

###คุณสมบัติหลัก:

1. การต้อนรับและลงทะเบียนนักศึกษา
- เมื่อนักศึกษา add เป็นเพื่อน ระบบจะส่งข้อความต้อนรับพร้อมแสดงปุ่มลงทะเบียน
- นักศึกษาจะต้องกรอกเลขบัตรประชาชน 13 หลัก และเลือกคณะของตนเอง

2. การเก็บข้อมูลในฐานข้อมูล PostgreSQL
- ระบบบันทึก LINE User ID, เลขบัตรประชาชน และคณะของนักศึกษา
- มีการตรวจสอบข้อมูลที่ซ้ำกันเพื่อป้องกันการบันทึกข้อมูลซ้ำ

3. การเพิ่ม tag คณะโดยอัตโนมัติ
- เมื่อนักศึกษาเลือกคณะ ระบบจะเพิ่ม tag คณะให้อัตโนมัติผ่าน LINE Messaging API
- มีการตรวจสอบว่า tag นั้นมีอยู่ในระบบหรือไม่ หากไม่มีก็จะสร้าง tag ใหม่

4. การส่งข่าวสารเฉพาะกลุ่มตาม tag
 - มีฟังก์ชัน send_message_to_faculty(faculty, message) สำหรับส่งข่าวสารเฉพาะกลุ่มตาม tag คณะ


วิธีการใช้งาน:
1. การตั้งค่า
- สร้างไฟล์ .env ที่มีค่าตัวแปรสำหรับ LINE API และฐานข้อมูล PostgreSQL
- ปรับแต่งรายชื่อคณะในตัวแปร FACULTIES ตามโครงสร้างของมหาวิทยาลัย


2. การปรับใช้

นำโค้ดนี้ไปปรับใช้บน server ที่รองรับ Flask application
ตั้งค่า Webhook URL ใน LINE Developer Console ให้ชี้ไปที่ /callback ของ application


การส่งข่าวสารถึงนักศึกษาเฉพาะคณะ

เรียกใช้ฟังก์ชัน send_message_to_faculty(faculty, message) เพื่อส่งข่าวสารถึงนักศึกษาเฉพาะคณะ
ตัวอย่าง: send_message_to_faculty("คณะวิศวกรรมศาสตร์", "ประกาศถึงนักศึกษาคณะวิศวกรรมศาสตร์: วันนี้มีการบรรยายพิเศษ")



คุณสามารถปรับแต่งโค้ดเพิ่มเติมตามต้องการ เช่น เพิ่มการตรวจสอบความถูกต้องของเลขบัตรประชาชน หรือเพิ่มฟังก์ชันอื่นๆ ตามความต้องการของมหาวิทยาลัยครับ
